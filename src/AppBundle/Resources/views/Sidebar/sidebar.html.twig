{% if getCity().imageName %}
    <div class="row mb-3">
        <div class="col-12">
            <a href="{{ path('frontpage') }}">
                <img class="mx-auto d-block" src="{{ vich_uploader_asset(getCity(), 'imageFile')|imagine_filter('logo') }}" alt="{{ getCity().title }}" />
            </a>
        </div>
    </div>
{% endif %}

{% if getCity().title or getCity().slogan %}
<div class="card mt-2">
    <div class="card-body text-center">
        <h4 class="card-title">
            {{ getCity().title }}
        </h4>

        {% if getCity().slogan %}
        <p class="card-text">
            {{ getCity().slogan }}
        </p>
        {% endif %}
    </div>
</div>
{% endif %}

{% if not app.user %}
<div class="card mt-2">
    <div class="card-body">
        <h4 class="card-title text-center">
            Login
        </h4>

        <p class="card-text text-center">
            Du kannst dich über eines dieser sozialen Netzwerke einloggen:
        </p>

        <div class="text-center">
            <div class="btn-group" role="group">
                <a href="{{ hwi_oauth_login_url('strava') }}" class="btn btn-secondary" style="background-color: rgb(249, 77, 31); color: white;">
                    Strava
                </a>

                <a href="{{ hwi_oauth_login_url('facebook') }}" class="btn btn-secondary" style="background-color: rgb(60, 90, 150); color: white;">
                    facebook
                </a>

                <a href="{{ hwi_oauth_login_url('twitter') }}" class="btn btn-secondary" style="background-color: rgb(57, 201, 214); color: white;">
                    twitter
                </a>
            </div>
        </div>

        <p class="card-text text-center">
            <small>
                <a href="{{ path('fos_user_security_login') }}">
                    Stattdessen mit Benutzername und Kennwort einloggen?
                </a>
            </small>
        </p>
    </div>
</div>
{% endif %}

{% if commentList|length > 0 %}
<div class="card mt-2">
    <div class="card-body">
        <h5 class="card-title text-center">
            Neuste Kommentare
        </h5>

        <ul>
            {% for comment in commentList %}
                <li>
                    <a href="{{ path('show_photo', { slug: comment.photo.slug }) }}#comments">
                        {{ comment.user.username }} bei {{ comment.photo.title }}
                    </a>
                </li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endif %}

{% if favouriteList|length > 0 %}
<div class="card mt-2">
    <div class="card-body">
        <h5 class="card-title text-center">
            Neuste Sternchen
        </h5>

        <ul>
            {% for favourite in favouriteList %}
                <li>
                    <a href="{{ path('show_photo', { slug: favourite.photo.slug }) }}#comments">
                        {{ favourite.user.username }} bei {{ favourite.photo.title }}
                    </a>
                </li>
            {% endfor %}
        </ul>
    </div>
</div>
{% endif %}

{% if getCity().criticalmassTitle and getCity().criticalmassCitySlug and criticalmass is defined %}
<div id="criticalmass-card" class="card mt-2">
    <div class="card-body">
        <h5 class="card-title text-center">
            {{ getCity().criticalmassTitle }}
        </h5>

        <p>
            Die nächste Tour ist am <strong>{{ criticalmass.dateTime|date('d.m.Y') }}</strong>:
        </p>
        <p>
            Treffpunkt: {{ criticalmass.location }}
            <br />
            Uhrzeit: {{ criticalmass.dateTime|date('H:i', 'Europe/Berlin') }} Uhr
        </p>

        <p class="text-center">
            <a class="btn btn-primary" href="https://criticalmass.in/{{ criticalmass.citySlug }}/{{ criticalmass.dateTime|date('Y-m-d') }}">
                mehr erfahren
            </a>
        </p>
    </div>
</div>
{% endif %}

{% if calendar is defined %}
    <div class="card mt-2">
        <div class="card-body text-center">
            <h4 class="card-title">
                Kalender
            </h4>
            <p class="card-text">
                Radverkehrstermine der nächsten Wochen
            </p>
        </div>

        <ul class="list-group list-group-flush">
            {% for calendarEntry in calendar.eventList %}
                <a href="{{ calendarEntry.permalink }}" class="list-group-item list-group-item-action flex-column align-items-start">
                    <div class="d-flex w-100 justify-content-between">
                        <h6 class="mb-1">{{ calendarEntry.title }}</h6>
                    </div>
                    <small>{{ calendarEntry.dateTime|date('d.m.Y H:i', 'Europe/Berlin') }} Uhr</small>
                </a>
            {% endfor %}
        </ul>
    </div>
{% endif %}

{% if luft is defined %}
    <div class="card mt-2">
        <div class="card-body text-center">
            <h4 class="card-title">
                Luft in {{ getCity().name }}
            </h4>

            <p class="card-text">
                Aktuelle Schadstoffwerte aus Hamburg
            </p>
        </div>

        <div class="list-group list-group-flush">
            {% for data in luft.dataList %}
                {% if data.level == 1 %}
                    {% set levelClass = 'list-group-item-success' %}
                {% endif %}

                {% if data.level == 2 %}
                    {% set levelClass = 'list-group-item-warning' %}
                {% endif %}

                {% if data.level == 3 %}
                    {% set levelClass = 'list-group-item-danger' %}
                {% endif %}

                {% if data.level == 4 %}
                    {% set levelClass = 'list-group-item-dark' %}
                {% endif %}

                <a href="https://luft.jetzt/{{ data.stationCode }}" class="list-group-item list-group-item-action {{ levelClass }}">
                    {{ data.pollutant }}: {{ data.value }} {{ data.unit }}
                    <br />
                    <span class="text-muted">{{ data.stationName }}</span>
                </a>
            {% endfor %}
        </div>

        <div class="card-body text-center">

            <p class="card-text">
                <small>
                    Daten gemessen vom Umweltbundesamt, aufbereitet von <a href="https://luft.jetzt/">Luft<sup>jetzt</sup></a>
                </small>
            </p>
        </div>
    </div>
{% endif %}


{% if weather is defined %}
    <div class="card mt-2">
        <div class="card-body text-center">
            <h4 class="card-title">
                Wetter
            </h4>

            <p class="card-text">
                Heute ist ein guter Tag zum Radfahren
            </p>
        </div>
        <ul class="list-group list-group-flush">
            <li class="list-group-item">
                {{ weather.weather }}
            </li>

            <li class="list-group-item">
                Temperatur:
                {% if weather.temperaturMin == weather.temperaturMax %}
                    {{ weather.temperaturMin }} °C
                {% else %}
                    {{ weather.temperaturMin }} bis {{ weather.temperaturMax }} °C
                {% endif %}
            </li>
        </ul>
        <div class="card-body text-center">
            <p class="card-text">
                <small>
                    Wetterdaten von <a href="http://openweathermap.org/">OpenWeatherMap</a>
                </small>
            </p>
        </div>
    </div>
{% endif %}
